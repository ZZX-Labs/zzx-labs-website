/* __partials/widgets/_core/widget-core.css
   DROP-IN REPLACEMENT

   GOALS (matching what you asked for, without touching anything else):
   - One consistent layout for the HUD wrapper you already have: 32 widgets in 2 columns (pairs), 15 rows
   - Runtime bar full-width (top)
   - bitcoin-ticker full-width (top, after runtime)
   - bitrng full-width (bottom)
   - HUD handle button right-aligned and ONLY visible when HUD is hidden (no JS required)
   - Works with BOTH conventions simultaneously:
       A) wrapper shell uses [data-widget-slot="..."]
       B) legacy CSS uses .btc-slot[data-widget="..."]
     (widget-core.js now mirrors data-widget automatically, so BOTH work)

   IMPORTANT:
   - DO NOT add display:contents anywhere.
   - No new fonts, no new files, no external dependencies.
*/

:root{
  --zzx-accent: #c0d674;
  --zzx-accent-alt: #e6a42b;
  --zzx-bg: #0b0b0b;
  --zzx-border: rgba(255,255,255,.14);
  --zzx-border-strong: #2a2a2a;
  --zzx-shadow: 0 6px 18px rgba(0,0,0,.25);

  --zzx-font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "DejaVu Sans Mono", monospace;

  /* Rail width: if your site defines --header-rail, this respects it */
  --zzx-rail: min(var(--header-rail, 1100px), 100%);
  --zzx-gap: .6rem;

  --zzx-hud-btn-h: 34px;
}

/* ----------------------------------------
   HUD HANDLE: right aligned, only when hidden
----------------------------------------- */
.zzx-hud-handle{
  width:100%;
  max-width: var(--zzx-rail);
  margin:.35rem auto 0;
  padding-inline:.5rem;
  box-sizing:border-box;

  position: sticky;
  top:.25rem;
  z-index: 9999;

  display:none;
  justify-content:flex-end;
  pointer-events:none;
}

/* Modern browsers: show ONLY if HUD is hidden */
@supports selector(:has(*)) {
  body:has([data-hud-root][data-hud-state="hidden"]) .zzx-hud-handle{ display:flex; }
}

/* Fallback: if :has() unsupported, keep visible so user isn’t stranded */
@supports not selector(:has(*)) {
  .zzx-hud-handle{ display:flex; }
}

.zzx-hud-show{
  pointer-events:auto;

  height: var(--zzx-hud-btn-h);
  line-height: calc(var(--zzx-hud-btn-h) - 2px);

  background:#000;
  color:var(--zzx-accent);
  border:1px solid rgba(255,255,255,.18);
  border-radius:10px;
  padding:0 .65rem;

  font-family:var(--zzx-font-mono);
  font-size:.95rem;
  letter-spacing:.02em;
  white-space:nowrap;

  cursor:pointer;
  display:inline-flex;
  align-items:center;
  justify-content:center;
}

.zzx-hud-show:hover{
  border-color:var(--zzx-accent-alt);
  color:var(--zzx-accent-alt);
}

/* ----------------------------------------
   HUD ROOT / RAIL
----------------------------------------- */
[data-hud-root]{
  width:100%;
  max-width: var(--zzx-rail);
  margin:.45rem auto;
  padding-inline:.5rem;
  box-sizing:border-box;
}

/* Hidden means hidden. Handle covers “get me back”. */
[data-hud-root][data-hud-state="hidden"]{ display:none !important; }

/* Your wrapper uses .btc-rail; keep it the one true rail */
.btc-rail{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  align-items:stretch;
  gap: var(--zzx-gap);
  width:100%;
}

/* ----------------------------------------
   SLOTS (2 columns contract)
   - base: 2-up
   - wider screens: still 2-up (because you explicitly want pairs/rows)
----------------------------------------- */
.btc-rail > .btc-slot{
  display:flex;
  box-sizing:border-box;

  /* 2 columns always (pairs) */
  flex: 1 1 calc(50% - var(--zzx-gap));
  min-width: 260px;
  max-width: 520px;
}

/* ----------------------------------------
   FULL-WIDTH SLOTS:
   runtime (top), bitcoin-ticker (top), bitrng (bottom)
   NOTE: wrapper uses data-widget-slot; core mirrors data-widget, so we match both.
----------------------------------------- */
.btc-rail > .btc-slot[data-widget-slot="runtime"],
.btc-rail > .btc-slot[data-widget="runtime"],
.btc-rail > .btc-slot[data-widget-slot="bitcoin-ticker"],
.btc-rail > .btc-slot[data-widget="bitcoin-ticker"],
.btc-rail > .btc-slot[data-widget-slot="bitrng"],
.btc-rail > .btc-slot[data-widget="bitrng"]{
  flex: 1 1 100% !important;
  max-width: 100% !important;
  justify-content:center;
}

/* ----------------------------------------
   CARD PRIMITIVES (support both .btc-card + .zzx-card)
----------------------------------------- */
.btc-card, .zzx-card{
  background:var(--zzx-bg);
  border:1px solid var(--zzx-border-strong);
  border-radius:10px;
  box-shadow:var(--zzx-shadow);
  padding:.55rem .65rem;
  color:var(--zzx-accent);
  font-family:var(--zzx-font-mono);

  width:100%;
  box-sizing:border-box;
}

/* Keep small widgets from stretching too wide visually */
.btc-rail > .btc-slot .btc-card{
  max-width: 520px;
}

/* Full-width cards should actually be full width */
.btc-rail > .btc-slot[data-widget-slot="runtime"] .btc-card,
.btc-rail > .btc-slot[data-widget="runtime"] .btc-card,
.btc-rail > .btc-slot[data-widget-slot="bitcoin-ticker"] .btc-card,
.btc-rail > .btc-slot[data-widget="bitcoin-ticker"] .btc-card,
.btc-rail > .btc-slot[data-widget-slot="bitrng"] .btc-card,
.btc-rail > .btc-slot[data-widget="bitrng"] .btc-card{
  max-width: 100% !important;
}

.btc-card__title, .zzx-card__title{
  color:var(--zzx-accent-alt);
  font-size:1rem;
  line-height:1.1;
  margin-bottom:.35rem;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.btc-card__value, .zzx-card__value{
  font-size:1.35rem;
  line-height:1.2;
  margin-bottom:.15rem;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.btc-card__sub, .zzx-card__sub{
  font-size:.95rem;
  color:#b7bf9a;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* Buttons used by built-in runtime (in widget-core.js) */
.zzx-widgets__btn{
  background:var(--zzx-bg);
  color:var(--zzx-accent);
  border:1px solid var(--zzx-border);
  border-radius:10px;
  padding:.35rem .55rem;
  font-family:var(--zzx-font-mono);
  cursor:pointer;
}
.zzx-widgets__btn:hover{
  border-color:var(--zzx-accent-alt);
  color:var(--zzx-accent-alt);
}

/* ----------------------------------------
   MODE: ticker-only
   Hide everything except:
   - runtime (so you can exit mode)
   - bitcoin-ticker
----------------------------------------- */
[data-hud-root][data-hud-state="ticker-only"] .btc-rail > .btc-slot{
  display:none !important;
}

/* Keep runtime visible */
[data-hud-root][data-hud-state="ticker-only"] .btc-rail > .btc-slot[data-widget-slot="runtime"],
[data-hud-root][data-hud-state="ticker-only"] .btc-rail > .btc-slot[data-widget="runtime"]{
  display:flex !important;
}

/* Keep ticker visible */
[data-hud-root][data-hud-state="ticker-only"] .btc-rail > .btc-slot[data-widget-slot="bitcoin-ticker"],
[data-hud-root][data-hud-state="ticker-only"] .btc-rail > .btc-slot[data-widget="bitcoin-ticker"]{
  display:flex !important;
}

/* Global containment patch — add to widget-core.css OR a shared primitives file */

.btc-slot,
.zzx-card,
.btc-card,
[data-widget-root]{
  min-width: 0;             /* critical for flex/grid overflow */
}

.btc-card,
.zzx-card{
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  overflow: hidden;         /* prevents charts/tables pushing past card edge */
}

.btc-card__value,
.zzx-card__value,
.btc-card__sub,
.zzx-card__sub{
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
}

canvas, svg, img, video{
  max-width: 100%;
  height: auto;
  display: block;
}

table{
  width: 100%;
  max-width: 100%;
  border-collapse: collapse;
}

pre, code{
  max-width: 100%;
  overflow-x: auto;
}

/* prevents long unbroken strings from forcing overflow */
.btc-card, .zzx-card, [data-widget-root]{
  overflow-wrap: anywhere;
  word-break: break-word;
}
